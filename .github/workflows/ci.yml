name: Build and Deploy Demo

on: # è§¦å‘æ—¶æœº
  push:
    branches:
      - main
  pull_request:

jobs:
  build:    # æ„å»º
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v3

      - name: ğŸ”§ Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18

      - name: ğŸ“¦ Install dependencies
        run: npm install

      - name: Test with vitest
        run: npm run test   # å­©å­ä»¬æˆ‘å¿˜è®°å†™æµ‹è¯•äº†

      - name: ğŸ— Build the project
        run: npm run build

      - name: Update version to npm with Changeset
        run: npx changeset publish
        env:
          NPM_TOKEN: ${{ secrets.NPM_TOKEN }}
        # run: npx changeset version ä¸è¦è¿™æ ·ï¼ŒCIçš„éƒ¨ç½²æ˜¯æš‚æ—¶çš„ï¼Œå˜æ›´æ–‡ä»¶ä¸ä¼šè¢«æäº¤åˆ°gitï¼Œå°±ç™½è·‘äº†
        # æœ€å¥½æ˜¯æ‰‹åŠ¨ä¿®æ”¹ç‰ˆæœ¬ï¼Œç„¶åå†pushè®©ciè‡ªåŠ¨å‘å¸ƒ
        # æˆ‘å˜ä¸ªç¼©è¿›è¯­æ³•å•Š